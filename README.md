# 📖 wn_os AI API 价格透视镜 

一个基于 Vue 3 的单页应用，用于通过比对不同渠道（OneAPI/NewAPI）的倍率配置，快速计算出 AI 模型的真实 Token 价格。

## ✨ 新增特性

- **💾 自动保存**：所有配置（渠道、汇率、映射规则等）会自动保存到浏览器本地存储，刷新页面不丢失。
- **📤 配置导入/导出**：支持将当前所有配置导出为 JSON 文件，或从文件恢复配置，方便备份或分享。
- **📦 充值套餐管理**：针对同一渠道支持设置多个充值套餐（不同汇率），一键切换计算成本。
- **🖐️ 拖拽排序**：
  - **渠道卡片**：按住卡片左侧手柄拖动，调整渠道排列顺序。
  - **表格列**：直接拖动表头，调整价格表中渠道的左右展示顺序。

---

## 🎛️ 顶部控制栏详解

控制栏位于页面最上方，决定了全站数据的展示维度。

### 1. 单位与货币
- **单位 (1K / 1M)**：切换价格显示单位。
  - `1K`：每 1,000 Tokens 的价格。
  - `1M`：每 1,000,000 Tokens 的价格（OneAPI 默认标准）。
- **货币 (倍率 / USD / CNY)**：
  - `倍率`：显示原始模型倍率（Ratio）。
  - `USD`：显示美元价格。会自动应用 **(充值汇率/基准汇率)** 的折扣系数。
  - `CNY`：显示人民币价格。计算公式为 `USD价格 × 基准汇率`。

### 2. 数据管理
- **映射 (⚙️)**：解决不同渠道模型命名不一致问题（如将 `gpt-4-svip` 映射到 `gpt-4` 进行同台比价）。
- **基准汇率**：设置当前真实的美元兑人民币汇率（如 `7.2`），影响 CNY 换算。
- **导出/导入**：备份或迁移你的渠道配置。
- **清除缓存**：一键重置所有数据到初始状态。

---

## 📊 渠道配置与比价

### 1. 添加数据源
- 点击 **"+ 添加渠道"**。
- **粘贴数据**：在文本框中粘贴 OneAPI/NewAPI 导出的分组倍率 JSON。
- **JSON 格式支持**：
  - 仅包含 `model_ratio` 的对象。
  - 包含 `data` 数组的完整导出格式。

### 2. 汇率与套餐 (核心功能)
为了计算真实成本，你需要告诉系统该渠道的资金成本：
- **简单模式**：直接在渠道卡片头部输入 **汇率**。
  - 例子：该站是 1元=1刀（1:1），填 `1`。若基准汇率是 7.2，系统会计算出约 1.4 折的超低价。
- **套餐模式 (⚙️)**：点击渠道旁边的齿轮图标。
  - 可以预设多个套餐（如“双十一特惠 6.5”、“平时充值 7.2”）。
  - 在卡片下拉框快速切换套餐，系统会自动更新该渠道的汇率并重新计算所有模型价格。

### 3. 分组与筛选
- **分组选择**：选择要查看的分组（如 `default`, `vip`）。
- **全部开关** (右下角)：
  - 🔴 **关闭**：仅显示该分组实际拥有的模型。
  - 🟢 **开启**：显示该分组没有，但该渠道其他分组可能有的模型。

---

## 📉 核心比价逻辑与排序

### 1. 价格展示
- **按量计费 (Token)**：
  - 主行：输入价格 (In)。
  - 副行 (灰色小字)：输出价格 (Out)。
  - **绿色高亮**：表示该价格是当前行所有渠道中的 **最低价**。
  - **折扣徽章**：如 `15%`，表示该价格是官方原价的 15%。
- **按次计费 (Quota=1)**：
  - 显示为 `xxx/次`。不参与最低价标绿。

### 2. 排序功能
点击表头的排序按钮可循环切换：
- **模型名列**：A-Z 排序 / Z-A 排序 / 官方基准顺序。
- **渠道价格列**：价格从低到高 / 价格从高到低 / 默认。
  - *提示：直接拖动表头可以交换列的位置。*

---

## 🚀 运行与部署

### 1. 本地运行
直接下载 `index.html`，双击使用浏览器打开即可。数据存储在你的浏览器本地。

### 2. Docker 部署
如果你希望在服务器上托管，可以使用 Docker。

**构建镜像**：
```bash
docker build -t wnos/ai-api-price-transparency:v0.2 .
```
